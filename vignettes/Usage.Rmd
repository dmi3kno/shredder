---
title: "Usage"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Usage}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Example

This is a basic example which shows you how to solve a common problem:

```{r example}
library(shredder)
library(rstan)
```

```{r,results='hide',warning=FALSE,message=FALSE}
rats <- shredder::rats_example(nCores = 1)
```

<details>
<summary> Standard Output </summary>

```{r}
rats
```

</details>
<br>

## Pars

### Names

```{r}
rats%>%
  stan_names()

rats%>%
  stan_names(expand = TRUE)
```

### Select

```{r}
rats%>%
  stan_select(mu_alpha)

rats%>%
  stan_select(mu_alpha,mu_beta)

rats%>%
  stan_select(!!!rlang::syms(c('mu_alpha','mu_beta')))


rats%>%
  stan_select(alpha[1],alpha[2])


rats%>%
  stan_select(!!!rlang::syms(sprintf('alpha[%s]',1:5)))

```

### Select with Partials

<details>
<summary> Select all Parameters that contain "alpha" </summary>


```{r}
rats%>%
  stan_select(stan_contains('alpha'))

```

</details>
<br>
 
```{r}
rats%>%
  stan_select(stan_contains('alpha\\[1\\]'))

rats%>%
  stan_select(stan_contains('alpha\\[[1-9]\\]'))

rats%>%
  stan_select(stan_ends_with('0'))

rats%>%
  stan_select(mu_alpha,stan_ends_with('0'),beta[1])
```

## Post-warmup samples

### Subsetting post warmup samples

<details>
<summary> First 50 with warmup samples </summary>

```{r}

  rats%>%
    stan_slice(1:50,inc_warmup = TRUE)

```

</details>
<br>

<details>
<summary> First 50 draws from each chain <em>without</em> warmup samples </summary>

```{r}
  rats%>%
    stan_slice(1:50,inc_warmup = FALSE)

```

</details>
<br>

<details>
<summary> Sample 100 draws from each Chain </summary>

```{r}
  rats%>%
    stan_sample_n(100)

```

</details>
<br>

<details>
<summary> Sample 50% of the Samples From each Chain </summary>

```{r}
  rats%>%
    stan_sample_frac(0.5)

```

</details>
<br>

### Select and Slice

```{r}
  rats%>%
    stan_select(mu_alpha)%>%
    stan_slice(1:50)

```

### Filter

```{r}
rats%>%
   stan_select(mu_alpha,mu_beta)
   
 rats%>%
   stan_select(mu_alpha,mu_beta)%>%
   stan_filter(mu_beta < 6)
```
